generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Cidade {
  id      Int    @id @default(autoincrement()) @map("id") @db.Int
  nome    String @map("nome") @db.VarChar(100)
  ufSigla String @default("RJ") @map("uf_sigla") @db.Char(2)

  bairros Bairro[]

  // Unique constraint on the combination of 'nome' and 'ufSigla'
  @@unique([nome, ufSigla])
  @@map("cidade")
}

model Bairro {
  id       Int        @id @default(autoincrement()) @map("id") @db.Int
  cidadeId Int        @map("cidade_id") @db.Int
  nome     String     @unique @map("nome") @db.VarChar(100)
  cidade   Cidade     @relation(fields: [cidadeId], references: [id])
  endereco Endereco[]

  @@map("bairro")
}

model Endereco {
  id          Int       @id @default(autoincrement()) @map("id")
  descricao   String?   @map("descricao") @db.VarChar(100)
  logradouro  String?   @map("logradouro") @db.VarChar(255)
  numero      String?   @map("numero") @db.VarChar(45)
  complemento String?   @map("complemento") @db.VarChar(255)
  cep         String?   @map("cep") @db.VarChar(9)
  bairroId    Int       @map("bairro_id") @db.Int
  bairro      Bairro    @relation(fields: [bairroId], references: [id])
  estacoes    Estacao[]

  @@map("endereco")
}

model Estacao {
  id               Int       @id @default(autoincrement()) @map("id")
  enderecoId       Int?      @map("endereco_id")
  endereco         String?   @map("endereco") @db.VarChar(300)
  identificador    String    @unique @map("identificador") @db.VarChar(100)
  descricao        String?   @map("descricao") @db.VarChar(100)
  fotoEstacao      String?   @map("foto_estacao") @db.VarChar(255)
  tipo             String    @default("interna") @map("tipo")
  latitude         Float?    @map("latitude") @db.Float
  longitude        Float?    @map("longitude") @db.Float
  ativa            Boolean   @default(true) @map("ativa")
  obs              String?   @map("obs") @db.Text
  enderecoRelation Endereco? @relation(fields: [enderecoId], references: [id])

  @@map("estacao")
}

model Leitura {
  id               Int       @id @default(autoincrement()) @map("id")
  datahora         DateTime  @map("datahora")
  estacaoId        Int       @map("estacao_id")
  temperatura      Float?    @map("temperatura")
  umidadeAr        Float?    @map("umidade_ar")
  velocidadeVento  Float?    @map("velocidade_vento")
  dirVento         String?   @map("dir_vento") @db.VarChar(5)
  volumeChuva      Float?    @map("volume_chuva")
  volumeAccChuva   Float?    @map("volume_acc_chuva")
  pressaoAtm       Float?    @map("pressao_atm")
  payload          String?   @map("payload") @db.Text
  datahoraCadastro DateTime? @map("datahora_cadastro")

  @@index([estacaoId], name: "fk_leitura_estacao1_idx")
  @@index([datahora])
  @@map("leitura")
}
